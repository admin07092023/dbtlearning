WITH REGIONS AS 
(
SELECT * 
 FROM {{ref('REGION_MODEL')}}
WHERE R_REGIONKEY IN (0,1)
),
NATIONS AS 
(
SELECT * 
FROM {{ref('NATION_MODEL')}}
WHERE N_REGIONKEY BETWEEN 1 AND 15
)
SELECT R_NAME,COUNT(*) AS NUMBER_OF_COUNTRIES
FROM REGIONS JOIN NATIONS 
ON REGIONS.R_REGIONKEY=NATIONS.N_REGIONKEY
GROUP BY R_NAME